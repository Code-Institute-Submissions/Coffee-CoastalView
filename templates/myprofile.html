{% extends 'base.html' %} {% block content %}
<div class="container">
   <div class="row">
      <div class="col s12 center-align">
         <h1>WELCOME</h1>
         <h6>{{ user_name }} welcome to your profile! </h6>
      </div>
   </div>
</div>
<div class="section">
   <div class="row">
      <div class="col s12 center-align">
      </div>
      <div class="col s12 center-align">
         <h6>My Details</h6>
         <p>Username: {{ user_name }}</p>
         <a href="{{ url_for('edit_user') }}" class="waves-effect waves-light btn light-blue lighten-3">Change Username</a>
         <a href="{{ url_for('logout') }}" class="waves-effect waves-light btn light-blue lighten-3">logout</a>
      </div>
   </div>
</div>
</div> 

<div class="col s12 center-align">
   <h4>CAFES I WANT TO VISIT</h4>
   <a class="waves-effect waves-light btn btn-flat modal-trigger blue-text light-blue lighten-3" href="{{ url_for('get_cafes') }}" class="secondary-content">Find Cafes to Add</a>
</div>
{% for cafe in cafes %}
<div class="container">
   <div class="row">
      <div class="col s6 offset-m3">
         <ul class="collection offset-m3" >
            <li class="collection-item avatar">
            <img src="../../{{cafe.imagepath}}" alt="" class="circle">
               <p>
                  {{cafe.name}}<br>
                  {{cafe.address}}<br>
               
               {% for favourite in cafe.favourites %}
                  {% if favourite.user_name == session['USERNAME'] %}  
                  <br>
                  
                  <a href="{{ url_for('remove_favourite', cafe_id=cafe._id, user_id=user_id) }}" class="secondary-content">Remove</a>
                  
                  {% endif %}
               {% endfor %}
               </p>
            </li>
         </ul>
         
      </div>
   </div>
</div>
{% endfor %} 

{% if my_reviews.count() != 0 %}
<div class="col s12 center-align">
   <h4>CAFES I HAVE REVIEWED</h4>
</div>
{% for cafe in my_reviews %}
<div class="container">
   <div class="row">
      <div class="col s6 offset-m3">
         <ul class="collection offset-m3" >
            <li class="collection-item avatar">
            <img src="../../{{cafe.imagepath}}" alt="" class="circle">
               <p>
                <h6>  {{cafe.name}}<br>
                  {{cafe.address}}</h6><br>
                  
               
               {% for review in cafe.reviews %}
                  {% if review.user_name == session['USERNAME'] %} 
                  "{{review.details}}" <br><br>
                  <a class="waves-effect waves-light btn btn-flat modal-trigger red accent-3" href="#DeleteModal">DELETE</a>
                  {% endif %}
               {% endfor %}
               </p>
            </li>
         </ul>
      </div>
   </div>
</div>
<div id="DeleteModal" class="modal">
            <div class=" modal-content">
                <p>Are you sure you want to delete your review?</p>
                
            </div>
            <div class="modal-footer">
                <button class="modal-close waves-effect waves-blue btn-flat blue-text light-blue lighten-3" type="submit"
                        name="action">No!
                </button>
                <a class="waves-effect waves-light btn btn-flat modal-trigger red accent-3" href="{{ url_for('remove_review', cafe_id=cafe._id, user_id=user_id) }}" class="secondary-content">Yes, Delete</a>
            </div>
    </div>
{% endfor %}
{% endif %}
{% endblock %}